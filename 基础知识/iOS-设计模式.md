# iOS-设计模式


## 设计原则

1. 开闭原则（Open Closed Principle，OCP）

开闭原则是总纲，它指导我们要对扩展开放，对修改关闭。

对于一个类，最好不让外部修改它内部的实现，而是通过组合、继承等手段来扩展类的功能。比如对于第三方库，不要直接修改其内部实现，可以使用组合或者继承手段扩展它。

2. 单一职责原则（Single Responsibility Principle, SRP）

单一职责原则指导我们实现类要职责单一。一个类实现的职责要单一，不要弄成大杂烩，可以通过拆分类的方式来精简类。

3. 里氏替换原则（Liskov Substitution Principle，LSP）

里氏替换原则指导我们不要破坏继承体系。任何使用父类的地方都能使用子类。

4. 依赖倒转原则（Dependency Inversion Principle，DIP）

依赖倒置原则指导我们要面向接口编程而不是实现编程。

面向接口编程的优势有： 1、通过暴露接口给外部使用，向外部隐藏实现细节；即使实现发生变化，外部也不需要改变调用接口。 2、通过实现多个接口，来避免多继承带来的类型爆炸问题。 
3、通过接口来实现多态。 框架实现中一般会大量用面向接口编程。比如iOS框架中大量用协议来实现多继承。

5. 接口隔离原则（Interface Segregation Principle，ISP）

接口隔离原则指导我们在设计接口的时候要精简单一。
一个类暴露的接口要尽量少。每个接口实现的功能要单一，一个接口不能做好几件事，通过拆分接口来让接口功能更加单一。

6. 组合/聚合复用原则（Composite/Aggregate Reuse Principle，CARP）

组合/聚合复用原则指导我们优先使用组合而不是继承。
使用组合而不是继承，不需要了解原类的实现，即时原类发生了变化，影响也也可以降至最低。
在UI编程上，大量的使用组合模式，通过组合控件来实现复杂界面。

7. 迪米特法则（Law of Demeter，LOD）

迪米特法则指导我们要降低耦合。
类的实现要高内聚、低耦合。


## 常用设计模式

### 对象创建

1. 单例模式
在整个应用程序中，共享一份资源，保证在程序运行的过程中，一个类只有一个实例，并且该实例只提供一个全局访问点工外界访问，从而方便控制实力个数，节约系统资源。
iOS中很多系统类都是使用单例模式实现的。比如UIApplication、NSFileManager。

实现单例注意点 
1、用dispatch_once 
2、把init和new标记为不可用，防止调用方直接实例化对象

优点是：提供了对唯一实例的受控访问，可拓展，避免频繁地创建销毁对象影响性能。
缺点是：延长了生命周期，一直在占用内存，如果两个单里循环依赖会造成死锁，所以尽量不去产生单例之间的依赖关系。


2. 工厂模式
通过类的继承创建抽象产品，创建一种产品，子类化创建者并且重载工厂方法用来创建新产品。

3. 抽象工厂模式
通过对象组合创建抽象产品，可以创建多系列产品，必须修改弗雷德解救才能支持新的产品。

### 结构型模式

1. 代理模式
用代理来处理事件的监听和参数的传递。
通信事件较多时delegate运行成本低而且不易造成循环引用。

2. 装饰模式
在不必改变袁磊文件和使用继承的情况下，动态的扩展一个对象的功能 例如：分类

3. 享元模式
使用共享物件，减少同一类对象大量创建。例如 UItableViewCell的复用。

### 行为型模式

1. 观察者模式 
本质上是一种发布-订阅模型，用来消除具有不同行为的对象之间的耦合，通过这一模式，不同对象可以协同工作。例如KVO



